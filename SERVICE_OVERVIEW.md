# CxO Letter Maker - サービス概要と改善点フィードバック依頼

## 📋 サービス概要

**CxO Letter Maker** は、経営層（CxO）向けの営業手紙・セールスレターをAIで自動生成するWebアプリケーションです。決裁者に「会いたい」と思わせる効果的なセールスレターを、低コストで作成できます。

### 主な目的
- 営業担当者が効果的なセールスレターを短時間で作成
- 5つの構成要素（背景・フック、課題、解決策、実績、オファー）に基づいた構造化された手紙の生成
- イベント招待状の作成にも対応

---

## 🎯 主要機能

### 1. **セールスレターモード**
- ターゲット企業・担当者情報の入力
- 5つの構成要素に基づいた手紙生成
- 自社情報（会社名、担当者名、サービス概要）の登録

### 2. **イベント招待モード**
- イベント情報（URL、名称、日時、登壇者）の入力
- 招待の背景（Why You?）の記述
- イベント招待状の自動生成

### 3. **AIアシスト機能**
- 各入力フィールドに対するAI提案（複数候補を提示）
- 構造提案機能（全体構成の提案）
- 外部ソース（URL、PDF、テキスト）からの情報抽出・分析

### 4. **文章編集・改善機能**
- **自動編集**: カジュアル化、事例強調、短縮などワンクリックで調整
- **品質改善**: Gemini 1.5 Pro による高品質化（追加コストあり）
- **プレビューエリア**: リアルタイム編集可能

### 5. **出力機能**
- クリップボードへのコピー
- Word形式（.docx）でのダウンロード

### 6. **履歴管理**
- LocalStorageを使用したブラウザ内保存（最大50件）
- 過去の作成履歴の確認・復元
- サイドバーでの履歴一覧表示

### 7. **マルチソース入力**
- URL、PDF、テキストファイルからの情報抽出
- 抽出した情報を自社情報またはターゲット情報として活用

---

## 🛠 技術スタック

### フロントエンド
- **Framework**: Next.js 16.0.10 (App Router)
- **Language**: TypeScript
- **UI Library**: React 19.2.1
- **Styling**: Tailwind CSS 4
- **Fonts**: Geist Sans, Geist Mono

### バックエンド
- **Runtime**: Next.js API Routes
- **AI SDK**: 
  - `@ai-sdk/google` (v2.0.46)
  - `@google/generative-ai` (v0.24.1)
  - `ai` (v5.0.113)
- **AI Model**: 
  - Gemini 2.0 Flash (標準生成・編集)
  - Gemini 1.5 Pro (品質改善)

### その他のライブラリ
- **Document Generation**: `docx` (v9.5.1) - Word出力
- **File Handling**: `file-saver` (v2.0.5)
- **PDF Parsing**: `pdf-parse` (v2.4.5), `pdfjs-dist` (v5.4.449)
- **HTML Parsing**: `cheerio` (v1.1.2) - URL解析用
- **Utilities**: `uuid` (v13.0.0)

### ストレージ
- **LocalStorage**: ブラウザ内履歴保存（最大50件）

---

## 📐 アーキテクチャ

### ディレクトリ構造
```
src/
├── app/
│   ├── api/
│   │   ├── generate/          # 手紙生成API
│   │   ├── edit/              # 自動編集API
│   │   ├── improve/           # 品質改善API
│   │   ├── assist/            # AIアシストAPI
│   │   ├── analyze-url/       # URL解析API
│   │   ├── analyze-source/    # ソース解析API
│   │   └── suggest-structure/ # 構造提案API
│   ├── layout.tsx
│   └── page.tsx
├── components/
│   ├── Header.tsx
│   ├── InputForm.tsx          # メイン入力フォーム
│   ├── PreviewArea.tsx        # プレビュー・編集エリア
│   ├── HistorySidebar.tsx     # 履歴サイドバー
│   ├── HistoryPanel.tsx
│   ├── MultiSourceModal.tsx   # マルチソース入力モーダル
│   └── StructureSuggestionModal.tsx
└── lib/
    └── historyUtils.ts        # 履歴管理ユーティリティ
```

### データフロー
1. ユーザーがフォームに入力
2. 「手紙を生成」ボタンクリック
3. `/api/generate` にPOSTリクエスト
4. Gemini APIで手紙生成
5. プレビューエリアに表示
6. 自動的に履歴に保存（LocalStorage）
7. 編集・出力可能

### API設計
- すべてのAPIは `/api/*` ルートで提供
- POSTリクエストでJSONを受け取り、JSONで応答
- エラーハンドリングは各APIで実装

---

## 🎨 UI/UXの特徴

### レイアウト
- **レスポンシブデザイン**: モバイル・デスクトップ対応
- **3カラムレイアウト**:
  - 左: 履歴サイドバー（3カラム）
  - 中央: 入力フォーム（5カラム）
  - 右: プレビューエリア（4カラム）

### 入力モード
- **ステップ入力**: 5つの構成要素を順に入力
- **フリーフォーム入力**: まとめて入力可能
- **AIアシスト**: 各フィールドに「AI提案」ボタン

### インタラクション
- モーダルダイアログでのAI提案表示
- リアルタイムプレビュー
- ワンクリック編集（カジュアル化、短縮など）
- 履歴からの復元機能

---

## 💰 コスト構造

| モデル | 用途 | 1通あたりのコスト |
|--------|------|------------------|
| Gemini 2.0 Flash | 標準生成・自動編集 | 約0.08円 |
| Gemini 1.5 Pro | 品質改善 | 約1.4円 |

※ 為替レート: 1ドル=150円で計算

---

## 🔒 セキュリティ対策

- APIキーは `.env.local` で管理（Gitにコミットされない）
- XSS対策: Reactの標準エスケープを使用
- 入力バリデーション: 各項目500文字制限
- LocalStorage使用: 機密情報は保存しない前提

---

## ⚠️ 既知の制限事項・課題

### 技術的制限
1. **LocalStorageの制限**
   - iOS Safariでは7日間でLocalStorageがクリアされる場合がある
   - 最大50件まで保存（それ以上は古いものから削除）

2. **PDF解析の制限**
   - PDF.jsを使用したクライアントサイド解析のため、大きなファイルでパフォーマンス問題の可能性

3. **エラーハンドリング**
   - 一部のAPIでエラーメッセージがユーザーに分かりにくい可能性

### UX上の課題
1. **入力の煩雑さ**
   - 5つの構成要素をすべて入力する必要がある
   - 初回利用者には入力項目が多すぎる可能性

2. **履歴管理**
   - 検索・フィルタリング機能がない
   - 履歴の削除機能がない（自動削除のみ）

3. **プレビュー編集**
   - 編集モードと表示モードの切り替えが分かりにくい可能性

---

## 🚀 デプロイ環境

- **推奨**: Vercel
- **環境変数**: `GOOGLE_GEMINI_API_KEY` を設定

---

## 📊 現在の実装状況

### 実装済み機能
✅ セールスレターモード  
✅ イベント招待モード  
✅ AIアシスト機能  
✅ 自動編集機能（カジュアル化、短縮、事例強調）  
✅ 品質改善機能（Proモデル）  
✅ 履歴管理（LocalStorage）  
✅ Word出力  
✅ マルチソース入力（URL、PDF、テキスト）  
✅ 構造提案機能  

### 未実装・改善の余地がある機能
- 履歴の検索・フィルタリング
- 履歴の手動削除
- テンプレート機能
- A/Bテスト機能（複数バージョン生成）
- コスト追跡機能
- エクスポート形式の追加（PDF、Markdownなど）
- チーム共有機能
- バックアップ・同期機能（クラウドストレージ連携）

---

## 🤔 改善点フィードバック依頼

以下の観点から、改善点のフィードバックをお願いします：

1. **アーキテクチャ・設計**
   - コード構造の改善点
   - パフォーマンス最適化の余地
   - スケーラビリティの課題

2. **UX/UI**
   - ユーザビリティの改善点
   - アクセシビリティの課題
   - モバイル体験の改善

3. **機能拡張**
   - 追加すべき機能
   - 既存機能の改善案

4. **セキュリティ**
   - セキュリティリスク
   - データ保護の改善点

5. **コスト最適化**
   - APIコスト削減の方法
   - キャッシュ戦略

6. **エラーハンドリング**
   - エラー処理の改善
   - ユーザーフィードバックの改善

7. **テスト・品質保証**
   - テスト戦略
   - 品質保証の方法

8. **ドキュメント**
   - 開発者向けドキュメントの不足
   - ユーザー向けドキュメントの改善

---

## 📝 補足情報

- **リポジトリ**: https://github.com/kazfoy/cxo-letter-maker
- **ライセンス**: MIT
- **バージョン**: 0.1.0

---

ご意見・ご提案をお待ちしております！

