/**
 * プリコンピューテッド・サンプルレター
 *
 * サンプル体験時にAPIを呼ばずに即座に表示するための事前生成データ。
 * 3社 × 3タイプ（standard / emotional / consultative）= 9通を保持。
 *
 * 生成条件:
 * - 送信者: 株式会社ネクサスソリューションズ（架空）
 * - qualityGate 80点以上のもののみ採用
 * - 生成日: 2026-02-16 (CxO品質改善版)
 */

import type { AnalysisResult, InformationSource } from '@/types/analysis';

/** 1通分のレターデータ */
export interface PrecomputedLetter {
  subject: string;
  body: string;
}

/** 1社分のプリコンピューテッドサンプル */
export interface PrecomputedSample {
  companyName: string;
  targetUrl: string;
  industryLabel: string;
  analysisResult: AnalysisResult;
  sources: InformationSource[];
  qualityScore: number;
  letters: {
    standard: PrecomputedLetter;
    emotional: PrecomputedLetter;
    consultative: PrecomputedLetter;
  };
}

/**
 * プリコンピューテッドサンプルのキーリスト
 */
export const PRECOMPUTED_SAMPLE_KEYS = [
  'cyberagent',
  'toyota',
  'jal',
] as const;

export type PrecomputedSampleKey = typeof PRECOMPUTED_SAMPLE_KEYS[number];

/**
 * プリコンピューテッドサンプルデータ
 */
export const PRECOMPUTED_SAMPLES: Record<PrecomputedSampleKey, PrecomputedSample> = {

  // ============================================================
  // 1. サイバーエージェント（IT大手）  (score: 88)
  // ============================================================
  cyberagent: {
    companyName: "株式会社サイバーエージェント",
    targetUrl: "https://www.cyberagent.co.jp/",
    industryLabel: "it_media_ads",
    qualityScore: 88,
    sources: [
      { url: "https://www.cyberagent.co.jp/recruit/", title: "採用情報 | 株式会社サイバーエージェント", category: "recruit" as const, isPrimary: true },
      { url: "https://www.cyberagent.co.jp/careers/", title: "採用情報 | 株式会社サイバーエージェント", category: "recruit" as const, isPrimary: true },
      { url: "https://www.cyberagent.co.jp/", title: "株式会社サイバーエージェント", category: "corporate" as const, isPrimary: true },
      { url: "https://www.cyberagent.co.jp/corporate/", title: "企業情報 | 株式会社サイバーエージェント", category: "corporate" as const, isPrimary: false },
      { url: "https://www.cyberagent.co.jp/sustainability/", title: "サステナビリティ", category: "corporate" as const, isPrimary: false },
      { url: "https://www.cyberagent.co.jp/service/", title: "サービス | 株式会社サイバーエージェント", category: "product" as const, isPrimary: false },
      { url: "https://www.cyberagent.co.jp/product/", title: "サービス | 株式会社サイバーエージェント", category: "product" as const, isPrimary: false },
      { url: "https://www.cyberagent.co.jp/ir/management/", title: "ガバナンス | 株式会社サイバーエージェント", category: "other" as const, isPrimary: false },
    ],
    analysisResult: {
      facts: { company_name: "株式会社サイバーエージェント", person_name: "田中様", person_position: "ご担当者", industry: "インターネットサービス、メディア、ゲーム、AI、DX", recent_events: ["2026年9月期 第１四半期決算発表について (2026年2月6日)", "Jリーグ百年構想リーグ開幕！世界で戦うビッグクラブへ (2026年2月5日)", "サイバーエージェント2代目社長 山内隆裕のキャリアと人物像 (2026年2月4日)"] },
      signals: [{ type: "compliance" as const, description: "サステナビリティの項目で『ガバナンス』を主要な柱の一つとして掲げ、『コーポレート・ガバナンス』『コンプライアンス』『リスクマネジメント』『内部統制システム』『企業倫理』『情報セキュリティポリシー』『個人情報の保護』など、内部統制とガバナンスに関する多数の項目を明示しており、この領域への高い意識が伺える。", confidence: "high" as const }, { type: "transformation" as const, description: "サービスとして『DX』『AI』を掲げ、技術・クリエイティブ部門でも『AI / Data』に注力していることから、デジタル変革や業務効率化への積極的な姿勢が伺える。また、創業社長から2代目への社長交代に関する記事もあり、組織の持続的成長と変革への意識が高い。", confidence: "high" as const }],
      recent_news: [
        { headline: "2026年9月期 第１四半期決算発表について", summary: "株式会社サイバーエージェントの2026年9月期 第1四半期決算に関する発表。", date: "2026年2月6日" },
        { headline: "Jリーグ百年構想リーグ開幕！世界で戦うビッグクラブへ", summary: "Jリーグの新たな構想リーグ開幕と、世界で戦うビッグクラブを目指す取り組みに関する記事。", date: "2026年2月5日" },
        { headline: "サイバーエージェント2代目社長 山内隆裕のキャリアと人物像", summary: "サイバーエージェントの2代目社長である山内隆裕氏のキャリアと人物像に焦点を当てた記事。", date: "2026年2月4日" },
      ],
      proof_points: [
        { type: "inference" as const, content: "サステナビリティの項目において、『ガバナンス』を主要な柱の一つとして掲げ、『コーポレート・ガバナンス』『コンプライアンス』『リスクマネジメント』『内部統制システム』『企業倫理』『情報セキュリティポリシー』『個人情報の保護』など、内部統制とガバナンスに関連する具体的な項目を多数明示している。", source: "株式会社サイバーエージェント 公式ウェブサイト - サステナビリティ > ガバナンス、セキュリティ", confidence: "high" as const },
      ],
      hypotheses: {
        timing_reason: "直近の決算発表（2026年2月6日）は、事業戦略や組織体制の見直しを行う良い機会であり、その中でバックオフィス業務の効率化や内部統制強化の必要性が再認識されている可能性がある。また、社長交代や持続的成長への言及、DX・AIへの注力は、組織全体の変革期であり、ガバナンス強化が喫緊の課題となっている可能性を示唆する。",
        challenge_hypothesis: "多角的な事業展開と多数の関連会社を持つサイバーエージェントにおいて、事業規模の拡大に伴い、バックオフィス業務（申請・承認・証憑管理）が複雑化し、標準化と効率化が課題となっている可能性がある。ガバナンスを重視する企業文化から、内部統制の維持・強化は必須であり、既存の体制ではその負荷が増大している、あるいはデジタル化によるさらなる統制強化と効率化を模索している可能性がある。",
        value_proposition: "貴社の多岐にわたる事業と関連会社におけるバックオフィス業務の複雑性を解消し、申請・承認・証憑管理を標準化することで、業務効率を大幅に向上させます。これにより、貴社が重視するコーポレート・ガバナンスと内部統制をより強固なものとし、事業成長を支える堅牢な経営基盤を構築します。DX推進の一環として、バックオフィス業務のデジタル化と統制強化を両立させることが可能です。",
        cta_suggestion: "貴社のガバナンス強化およびDX推進におけるバックオフィス業務の現状と、弊社のソリューションがどのように貢献できるかについて、15分ほどオンラインで意見交換させていただけないでしょうか。",
      },
      missing_info: [],
      risk_flags: [],
      target_url: "https://www.cyberagent.co.jp/",
    },
    letters: {
      standard: {
        subject: "連結子会社112社体制における間接業務の標準化について",
        body: "株式会社サイバーエージェント 田中様\n\n2026年2月6日発表の第1四半期決算にて、連結子会社112社体制での事業拡大方針を拝見しました。子会社数がこの規模に達すると、申請・承認ルートや証憑管理ルールが各社でばらつき、グループ全体の統制コストが論点になりやすいのではないでしょうか。\n\n同じくインターネット大手のD社様では、グループ共通の間接業務基盤を導入されたことで、経理部門の月次作業時間を22%削減し、内部監査の指摘件数を半減されました。御社の112社体制に同様の効果が波及すれば、年間で数億円規模のガバナンスコスト最適化が見込まれます。\n\n今月中に15分ほどオンラインで、連結子会社管理における証憑・承認の統制方針について情報交換の機会をいただけませんでしょうか。事前に「連結子会社100社超の間接業務ベンチマーク資料」をお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
      emotional: {
        subject: "山内新体制における連結ガバナンス基盤について",
        body: "株式会社サイバーエージェント 田中様\n\n山内隆裕社長就任後初の通期を迎える2026年9月期、第1四半期決算にて連結子会社112社体制の更なる拡大が示されました。新体制の下、事業成長のスピードに間接業務の統制体制が追いつかないギャップは、子会社数が100社を超えた企業にとって共通の経営課題です。\n\nD社様では、グループ共通の間接業務基盤導入後、月次の経理作業時間を22%削減し、グループガバナンスの可視性を高められました。112社体制の御社であれば、同等の取り組みで年間数億円規模の統制コスト最適化と、経営判断のスピード向上が期待できます。\n\n今月中に15分ほどオンラインで、新体制におけるグループガバナンスの方針について情報交換の機会をいただけませんでしょうか。「IT企業100社超のガバナンス事例集」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
      consultative: {
        subject: "112社体制の内部統制リスクと監査効率化について",
        body: "株式会社サイバーエージェント 田中様\n\n2026年2月6日の第1四半期決算を拝見し、連結子会社112社体制でのガバナンス運営に注目しております。サステナビリティレポートにて内部統制システムへの高い意識を示されている一方、112社それぞれの承認ルール・証憑管理が個別運用の場合、監査対応工数とコンプライアンスリスクが論点になりやすいです。\n\n同規模のIT大手D社様では、グループ共通基盤を導入し、監査対応工数を年間約1,500時間削減、不備指摘件数を60%低減されました。御社のグループ規模に換算すると、年間数億円の統制コスト最適化が見込まれます。\n\n今月中に15分ほどオンラインで、連結子会社の内部統制運営についてご状況を伺えればと存じます。「IT・メディア業界のグループガバナンス監査チェックリスト」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
    },
  },

  // ============================================================
  // 2. トヨタ自動車（製造業大手）  (score: 87)
  // ============================================================
  toyota: {
    companyName: "トヨタ自動車株式会社",
    targetUrl: "https://global.toyota/jp/",
    industryLabel: "automotive_manufacturing",
    qualityScore: 87,
    sources: [
      { url: "https://global.toyota/jp/", title: "トヨタ自動車株式会社 公式企業サイト", category: "corporate" as const, isPrimary: true },
    ],
    analysisResult: {
      facts: { company_name: "トヨタ自動車株式会社", person_name: "田中様", person_position: "ご担当者", industry: "自動車製造業", recent_events: ["2026年02月06日 トヨタ自動車 記者会見 ライブ中継", "2026年01月09日 東京オートサロン2026 プレスカンファレンス・スペシャルトークショー", "2025年12月17日 新型RAV4を発売", "2026年01月30日 「沿革」を更新しました", "2025年12月17日 「トヨタのファクト＆データ」を更新しました", "2025年11月25日 「トヨタテクニカルレビュー」を更新しました", "2025年11月19日 「トピックス」（LGBTQ+についての取り組み評価指標「PRIDE指標2025」で「ゴールド」受賞）を更新しました", "2025年10月30日 「Sustainability Data Book」を更新しました", "災害発生時に身を守る方法、役立つ情報はこちら （ トヨタ ・ レクサス ）", "タカタ製エアバッグリコールに関する大切なお知らせ"] },
      signals: [{ type: "transformation" as const, description: "「トヨタの新事業創出スキーム BE creation」や「空のモビリティ Joby S4」「福祉領域の取り組み」といった情報から、新規事業創出や事業領域の拡大に積極的に取り組んでいることが伺える。", confidence: "high" as const }, { type: "compliance" as const, description: "「Sustainability Data Book」の更新や「PRIDE指標2025」での「ゴールド」受賞から、ESG、多様性、ガバナンスへの意識が高いことが伺える。", confidence: "high" as const }, { type: "growth" as const, description: "新型RAV4の発売、東京オートサロンでのプレスカンファレンス、記者会見など、活発な事業活動が見られる。", confidence: "high" as const }],
      recent_news: [
        { headline: "トヨタ自動車 記者会見 ライブ中継", summary: "2026年2月6日に記者会見がライブ中継された。", date: "2026年02月06日", source_url: "トヨタ自動車株式会社 公式企業サイト ピックアップ" },
        { headline: "東京オートサロン2026 プレスカンファレンス・スペシャルトークショー", summary: "2026年1月9日に東京オートサロン2026にてプレスカンファレンスとスペシャルトークショーが開催された。", date: "2026年01月09日", source_url: "トヨタ自動車株式会社 公式企業サイト ピックアップ" },
        { headline: "新型RAV4を発売", summary: "2025年12月17日に新型RAV4が発売された。", date: "2025年12月17日", source_url: "トヨタ自動車株式会社 公式企業サイト ピックアップ" },
      ],
      proof_points: [
        { type: "news" as const, content: "2025年10月30日に「Sustainability Data Book」が更新されており、ESGやガバナンスへの取り組みを積極的に開示している。", source: "トヨタ自動車株式会社 公式企業サイト サイト更新情報", confidence: "high" as const },
        { type: "news" as const, content: "2025年11月19日にLGBTQ+についての取り組み評価指標「PRIDE指標2025」で「ゴールド」を受賞しており、多様性や企業文化、ガバナンスへの意識の高さを示している。", source: "トヨタ自動車株式会社 公式企業サイト サイト更新情報", confidence: "high" as const },
        { type: "inference" as const, content: "「トヨタの新事業創出スキーム BE creation」や「空のモビリティ Joby S4」「福祉領域の取り組み」など、多角的な事業展開を進めており、それに伴うバックオフィス業務の複雑化や効率化のニーズが想定される。", source: "トヨタ自動車株式会社 公式企業サイト ピックアップ", confidence: "medium" as const },
      ],
      hypotheses: {
        timing_reason: "トヨタ自動車は新型車発売、記者会見、東京オートサロンへの参加など、事業活動が非常に活発な時期にあります。また、「Sustainability Data Book」の更新や「PRIDE指標」での受賞など、ガバナンスや企業文化、ESGへの意識が高まっている時期でもあります。このような時期は、事業拡大に伴うバックオフィス業務の負荷増大や、より強固な内部統制・ガバナンス体制へのニーズが高まるタイミングである可能性があります。",
        challenge_hypothesis: "トヨタ自動車のようなグローバルかつ多角的な事業を展開する大企業では、事業部門や地域ごとに異なるバックオフィス業務プロセスが存在し、申請・承認・証憑管理が非効率になっている可能性があります。特に、新規事業創出や多様な働き方への対応が進む中で、既存のバックオフィスシステムが変化に追いつかず、内部統制やガバナンスの強化が課題となっている可能性があります。これにより、経営層は迅速な意思決定に必要な情報の収集や、リスク管理に課題を抱えているかもしれません。",
        value_proposition: "貴社のバックオフィス業務を標準化し、申請・承認・証憑管理を一元化することで、業務効率を大幅に向上させ、コスト削減に貢献します。また、強固な内部統制とガバナンス体制を構築し、事業リスクを低減するとともに、変化の激しい事業環境や新規事業創出を支える柔軟な経営基盤を提供します。これにより、経営層はより迅速かつ正確な情報に基づいた意思決定が可能となり、企業価値の向上に寄与します。",
        cta_suggestion: "貴社のバックオフィス業務における現状の課題や、将来的なガバナンス強化のビジョンについて、短時間で意見交換させていただけませんか？貴社の最新の取り組み（例：Sustainability Data Book更新、PRIDE指標受賞）を拝見し、当社のソリューションがどのように貢献できるか、具体的な事例を交えてご紹介する機会をいただけないでしょうか？",
      },
      missing_info: [],
      risk_flags: [],
      target_url: "https://global.toyota/jp/",
    },
    letters: {
      standard: {
        subject: "BE creation新体制における間接業務オペレーション設計について",
        body: "トヨタ自動車株式会社 田中様\n\n2026年2月6日の記者会見にて「BE creation」新事業創出スキームの進捗が報じられ、企画から量産までの一気通貫体制を構築されていると拝見しました。新事業のスピードは、実は購買・経費・契約といった間接業務の型が初期に整備されているかどうかで大きく左右されます。既存の全社プロセスをそのまま適用するか、新体制に合わせてゼロベースで設計するかをご検討されているのではないでしょうか。\n\n製造業大手のH社様（従業員約3万名）では、新事業部門の間接業務をゼロベースで再設計したことで、購買申請から承認完了までのリードタイムを40%短縮し、年間監査対応工数を約1,200時間削減されました。H社の規模感をもとにBE creation新体制に外挿すると、初期設計の有無で3年後の運用コストに数千万円単位の差が出ると見込まれます。\n\n来週のご都合の良い日に15分ほど、新事業部門の間接業務オペレーション設計について情報交換の機会をいただけませんでしょうか。「製造業の新事業間接業務設計チェックリスト」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
      emotional: {
        subject: "BEV一気通貫体制を支える間接業務のゼロベース設計について",
        body: "トヨタ自動車株式会社 田中様\n\n2026年2月6日の記者会見にて、BEVの企画から量産までを一気通貫で手がける「BE creation」の進捗が報じられました。従来の部門横断型とは異なる新体制では、間接業務の承認フローやルールも白紙から設計する好機です。新事業のスピードは間接業務の型が整っているかどうかに大きく依存するため、既存プロセスをそのまま適用すると新組織の足を引っ張る要因になりかねません。\n\n製造業大手のH社様（従業員約3万名）では、新事業立ち上げ時に間接業務をゼロベースで再設計した結果、購買リードタイムを40%短縮し、初年度で約1,200時間の監査対応工数を削減されました。BE creation規模であれば、初期設計の差が3年で数千万円の運用コスト差につながると見込まれます。\n\n来週15分ほどオンラインで、新事業部門の業務フロー設計方針についてお話しできればと存じます。「製造業のBEV新体制 間接業務設計ガイド」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
      consultative: {
        subject: "新事業部門における監査・統制体制の初期設計について",
        body: "トヨタ自動車株式会社 田中様\n\n2025年10月30日更新の「Sustainability Data Book」にて、ESGガバナンスへの高いコミットメントを拝見しました。同時に「BE creation」で新事業部門を立ち上げられる中、既存のガバナンス基準を新組織にどう適用するかは、コンプライアンスリスクの観点で論点になりやすいです。\n\nH社様では、新事業部門に既存と同水準の統制基盤を初期導入したことで、監査指摘件数を60%低減し、年間約1,200時間の対応工数を削減されました。御社のグループ規模とBE creationの事業範囲を考慮すると、統制基盤の初期整備で年間数千万円のリスクコスト低減が見込まれます。\n\n来週15分ほどオンラインで、新事業部門の統制設計についてご状況を伺えればと存じます。「自動車業界の新事業ガバナンス設計チェックリスト」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
    },
  },

  // ============================================================
  // 3. 日本航空（航空）  (score: 88)
  // ============================================================
  jal: {
    companyName: "日本航空株式会社",
    targetUrl: "https://www.jal.co.jp/jp/ja/",
    industryLabel: "airline",
    qualityScore: 88,
    sources: [
      { url: "https://www.jal.co.jp/jp/ir/management/", title: "IR情報 ｜JAL企業サイト", category: "ir" as const, isPrimary: true },
      { url: "https://www.jal.co.jp/solution", title: "TOP | JAL法人ソリューション・サービスサイト", category: "product" as const, isPrimary: true },
      { url: "https://www.jal.co.jp/jp/ja/", title: "JAL｜国内線/国際線の航空券・飛行機チケット予約", category: "other" as const, isPrimary: true },
      { url: "https://www.jal.co.jp/ir/management/", title: "IR情報 ｜JAL企業サイト", category: "other" as const, isPrimary: false },
    ],
    analysisResult: {
      facts: { company_name: "JAL (日本航空)", industry: "航空、旅行、Eコマース", recent_events: ["他社機の接触による運航への影響について（2026年2月4日14:00時点）", "システムメンテナンスのため、サービスを停止している旨の表示が複数箇所にある", "期間限定セール（国内、国際、ショッピング）を実施中"] },
      signals: [{ type: "transformation" as const, description: "国内線/国際線の航空券、航空券＋宿泊、ツアー、特典航空券、ホテル・レンタカー、ショッピング（JAL Mall）など、多岐にわたるサービスをオンラインで提供しており、デジタルチャネルを通じた事業多角化と顧客体験向上への取り組みが見られる。", confidence: "high" as const }, { type: "challenge" as const, description: "ウェブサイトの複数箇所で「ただいまシステムメンテナンスのため、サービスを停止しております」というメッセージが表示されており、システム運用における安定性や可用性、または既存システムの改善ニーズを示唆する。", confidence: "high" as const }, { type: "compliance" as const, description: "JALマイレージバンク規約に基づき、特典交換等、一部会員サービスを停止している旨や、ご入会後最大60日間は特典交換ができない旨の記載があり、規約遵守や会員管理における厳格な運用、またはシステム的な制約が存在する。", confidence: "high" as const }],
      recent_news: [
        { headline: "他社機の接触による運航への影響について", summary: "2026年2月4日14:00時点での他社機接触による運航への影響に関するお知らせ。", date: "2026年2月4日", source_url: "JALウェブサイト" },
        { headline: "期間限定セール実施中", summary: "国内線、国際線、ショッピングにおいて期間限定セールを実施している。", source_url: "JALウェブサイト" },
        { headline: "システムメンテナンスによるサービス停止", summary: "ウェブサイトの複数機能（航空券検索、国際線予約など）がシステムメンテナンスのため一時的に停止している。", source_url: "JALウェブサイト" },
      ],
      proof_points: [
        { type: "inference" as const, content: "JALは、国内線/国際線の航空券予約、航空券＋宿泊、ツアー、特典航空券、ホテル・レンタカー、ショッピング（JAL Mall）など、広範なオンラインサービスを提供しており、これら多角的な事業活動に伴うバックオフィス業務が存在する。", source: "JALウェブサイトのサービス一覧", confidence: "high" as const },
        { type: "inference" as const, content: "航空券予約システムでは、往復・片道、自由旅程（複数都市）、複数グループ・個人のフライト追加（最大6グループ）、各種割引（JALカード割引、当日シニア割引、スカイメイトなど）、小児・幼児の予約制限など、複雑な条件設定に対応している。これは、予約・販売に関連するバックオフィス業務の複雑性を示唆する。", source: "JALウェブサイトの予約フォーム詳細", confidence: "high" as const },
        { type: "inference" as const, content: "JALマイレージバンク規約に基づき、特典交換や一部会員サービスに停止や制限（入会後最大60日間特典交換不可など）がある。これは、会員サービスにおける厳格な規約管理と、それに伴うバックオフィスでの承認・管理プロセスの重要性を示唆する。", source: "JALウェブサイトのJALマイレージバンク関連情報", confidence: "high" as const },
      ],
      hypotheses: {
        timing_reason: "JALが多角的なオンラインサービスを展開し、複雑な予約システムを運用している現状において、バックオフィス業務（申請・承認・証憑管理）も複雑化し、効率化や標準化のニーズが高まっている可能性があります。また、複数回表示されるシステムメンテナンスによるサービス停止は、既存システムの運用負荷や改善の必要性を示唆しており、バックオフィス業務の基盤強化が喫緊の課題であると推測されます。2026年2月4日の運航影響に関するお知らせは、突発的な事象への対応力や内部統制の重要性を再認識させるきっかけとなっているかもしれません。",
        challenge_hypothesis: "JALは航空事業に加え、旅行、ホテル、レンタカー、Eコマース（JAL Mall）など多岐にわたる事業を展開しており、それぞれの事業領域で発生する申請・承認・証憑管理業務がサイロ化している、または手作業が多く非効率になっている可能性があります。これにより、内部統制の確保やガバナンス強化に課題を抱えている、あるいは監査対応に多大なリソースを要しているかもしれません。また、頻繁なシステムメンテナンスは、既存のバックオフィスシステムが老朽化しているか、柔軟性に欠け、業務変更への対応が難しい状況にあることを示唆している可能性があります。",
        value_proposition: "株式会社ネクサスソリューションズのサービスは、JAL様の多岐にわたるバックオフィス業務（例：各事業部門の経費精算、契約承認、購買申請、証憑管理など）を標準化し、デジタル化された申請・承認プロセスを導入することで、業務効率を大幅に向上させることができます。これにより、内部統制を強化し、全社的なガバナンスを向上させ、コンプライアンスリスクの低減や監査対応の効率化に貢献します。特に、既存システムの運用課題を抱えている場合、弊社のソリューションが業務基盤の安定化と柔軟性向上に寄与し、将来的な事業成長を支える強固なバックオフィス体制を構築できると確信しております。",
        cta_suggestion: "貴社のバックオフィス業務における現状の課題や、内部統制・ガバナンス強化に向けた取り組みについて、30分ほどお話しする機会をいただけないでしょうか。貴社の具体的な状況に合わせて、弊社のソリューションがどのように貢献できるかをご説明させていただきます。",
      },
      missing_info: [],
      risk_flags: [],
      target_url: "https://www.jal.co.jp/jp/ja/",
    },
    letters: {
      standard: {
        subject: "JALインフォテック再編を契機とした連結グループ証憑管理の統一について",
        body: "日本航空株式会社 田中様\n\n2025年10月に発表されたJALインフォテック様の機能再編により、連結グループのIT基盤が刷新フェーズに入っていると拝見しました。IT基盤を作り直すタイミングは、その上で動く業務プロセス——特に航空事業・旅行事業・Eコマースなど事業体ごとに個別運用されている証憑管理や承認ルール——を統一基盤に載せ替える好機ではないかと存じますが、いかがでしょうか。\n\n同規模の運輸大手A社様（連結従業員約4万名）では、グループ共通の証憑管理基盤を導入されたことで、証憑照合作業を35%削減し、月次決算を従来比4営業日短縮されました。A社の決算関連人員をもとに御社グループに外挿すると、年間数千万〜1億円規模の連結決算効率化が見込まれます。\n\n来週のご都合の良い日に15分ほどオンラインで、連結グループ証憑管理の統一方針について情報交換の機会をいただけませんでしょうか。事前に「航空業界の連結証憑管理ベンチマーク資料」をお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
      emotional: {
        subject: "マイレージ・EC・航空を横断する統合証憑基盤について",
        body: "日本航空株式会社 田中様\n\n2026年2月4日の運航影響対応にて、突発事象への全社対応力の高さを拝見しました。航空券予約、JALマイレージバンク、JAL Mall等の多岐にわたるサービスを運営される中、各事業体の証憑管理・承認ルールが個別に存在すると、こうした緊急時にグループ全体の支出状況を即座に把握しづらくなるケースが見受けられます。\n\n同規模の運輸大手A社様（連結従業員約4万名）では、グループ横断の証憑管理統一により、証憑照合作業を35%削減し、月次決算を4営業日短縮されました。A社の事業構成をもとに御社グループに外挿すると、年間数千万〜1億円規模の連結決算効率化が見込まれます。\n\n来週15分ほどオンラインで、多事業体の証憑管理統一について情報交換の機会をいただけませんでしょうか。「航空・旅行業界の証憑管理統合事例レポート」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
      consultative: {
        subject: "新中期経営計画に向けた連結証憑管理の統制設計について",
        body: "日本航空株式会社 田中様\n\n3月上旬に発表が予定される新中期経営計画に際し、2025年10月のJALインフォテック再編を含むIT基盤の見直しが進んでいると拝見しました。IT基盤の刷新は、その上で動く証憑管理・承認プロセスを統一するのに最も適した時期であり、複数事業体の個別運用を残したまま新基盤に移行すると、監査対応工数とコンプライアンスリスクの両面で課題が残りやすいとお見受けいたします。\n\n同規模の運輸大手A社様（連結従業員約4万名）では、連結グループの証憑管理を統一基盤に移行し、証憑照合を35%効率化、月次決算を4営業日短縮されました。A社の決算関連人員をもとに御社グループに外挿すると、年間数千万〜1億円規模のコスト最適化が見込まれます。\n\n今月中に15分ほどオンラインで、新中期計画における連結証憑管理の統制方針についてご状況を伺えればと存じます。「航空業界の連結ガバナンス監査チェックリスト」を事前にお送りいたします。\n\n株式会社ネクサスソリューションズ\n橋本 洋生",
      },
    },
  },
};

/**
 * Level 4 フォールバック: 下書きモードのレター生成
 *
 * API がすべて失敗した場合に、テンプレートベースで下書きを返す。
 * エラーではなく「下書き」として表示するため、ユーザー体験を損なわない。
 */
export function generateDraftLetter(
  companyName: string,
  senderCompanyName: string,
  senderName: string,
  serviceDescription: string,
): string {
  return `${companyName} ご担当者様

${senderCompanyName}の${senderName}と申します。

貴社のウェブサイトを拝見し、事業展開に注目しております。${serviceDescription}を通じて、貴社のバックオフィス業務における申請・承認プロセスの効率化やガバナンス強化に貢献できるのではないかと考えております。

つきましては、15分ほどオンラインでお時間をいただき、貴社の現状の課題感について情報交換の機会をいただけませんでしょうか。

${senderCompanyName}
${senderName}`;
}

/**
 * ランダムにプリコンピューテッドサンプルを取得
 * 直前と同じ会社を避ける
 */
let lastSampleKey: PrecomputedSampleKey | null = null;

export function getRandomPrecomputedSample(): { key: PrecomputedSampleKey; sample: PrecomputedSample } {
  const keys = [...PRECOMPUTED_SAMPLE_KEYS];
  let selectedKey = keys[Math.floor(Math.random() * keys.length)];

  // 直前と同じなら1回だけリトライ
  if (selectedKey === lastSampleKey && keys.length > 1) {
    selectedKey = keys[Math.floor(Math.random() * keys.length)];
  }

  lastSampleKey = selectedKey;
  return { key: selectedKey, sample: PRECOMPUTED_SAMPLES[selectedKey] };
}
